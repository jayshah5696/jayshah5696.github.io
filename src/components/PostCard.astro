---
import FormattedDate from './FormattedDate.astro';
import TagList from './TagList.astro';
import readingTime from 'reading-time';

interface Props {
  title: string;
  date: Date;
  description: string;
  slug: string;
  tags: string[];
  body: string;
  image?: string;
  featured?: boolean;
}

const { title, date, description, slug, tags, body, image, featured = false } = Astro.props;
const stats = readingTime(body);
---

<article class="group rounded-xl border border-cream-200 dark:border-night-700 
  bg-white dark:bg-night-800 hover:shadow-lg hover:border-cream-300 dark:hover:border-night-600
  transition-all duration-200 overflow-hidden rangoli-corners">
  <a href={`/posts/${slug}/`} class="flex flex-col sm:flex-row">
    <!-- Text content -->
    <div class="flex-1 p-5">
      <h2 class:list={[
        'font-display text-ink dark:text-silk group-hover:text-terra dark:group-hover:text-terra-light transition-colors duration-200 text-balance leading-snug',
        featured ? 'text-xl' : 'text-lg',
      ]}>
        {title}
      </h2>
      <p class="mt-2 text-sm text-ink-light dark:text-silk-muted text-pretty line-clamp-2 leading-relaxed">
        {description}
      </p>
      <div class="flex items-center gap-3 mt-3 text-ink-muted dark:text-silk-faint">
        <span class="inline-flex items-center gap-1.5">
          <svg class="size-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M16 2v4M8 2v4m-5 4h18"/></svg>
          <FormattedDate date={date} />
        </span>
        <span class="text-cream-400 dark:text-night-700 text-xs select-none">&bull;</span>
        <span class="font-mono text-xs tabular-nums">{stats.text}</span>
      </div>
    </div>

    <!-- Hero image -->
    {image && (
      <div class="sm:w-[200px] h-[140px] sm:h-auto shrink-0 overflow-hidden">
        <img
          src={image}
          alt={title}
          class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
          loading="lazy"
        />
      </div>
    )}
  </a>

  {tags.length > 0 && (
    <div class="px-5 pb-4 -mt-1">
      <TagList tags={tags} />
    </div>
  )}
</article>
